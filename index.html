<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimeCaps</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body class="min-h-screen flex items-center justify-center bg-amber-50">
    <div class="bg-white p-6 rounded-lg shadow-md max-w-md w-full">
        <h1 class="text-xl font-bold text-amber-800 mb-4">Create Time Capsule</h1>
        <input id="capsuleTitle" class="w-full p-2 mb-4 border rounded" placeholder="Capsule Title">
        <textarea id="capsuleDescription" class="w-full p-2 mb-4 border rounded" placeholder="Description"></textarea>
        <input id="unlockDate" type="date" class="w-full p-2 mb-4 border rounded">
        <button id="sealButton" class="w-full bg-amber-500 text-white p-2 rounded">Seal Capsule</button>
        <p id="result" class="mt-4 text-center"></p>
    </div>
    <script>
        // Твой Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyAFFEMu2sm9XDJgGUrX4wUG3TPZ9UiwjzU",
            authDomain: "timecaps-8f759.firebaseapp.com",
            projectId: "timecaps-8f759",
            storageBucket: "timecaps-8f759.firebasestorage.app",
            messagingSenderId: "777140343852",
            appId: "1:777140343852:web:c6701944e99c0d0bcfad89"
        };

        // Инициализация Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        document.getElementById('sealButton').addEventListener('click', function() {
            const title = document.getElementById('capsuleTitle').value;
            const description = document.getElementById('capsuleDescription').value;
            const unlockDate = document.getElementById('unlockDate').value;
            const user = window.Telegram.WebApp.initDataUnsafe.user || { id: 'testUser' };

            if (title && description && unlockDate) {
                db.collection('capsules').add({
                    title: title,
                    description: description,
                    unlockDate: unlockDate,
                    userId: user.id,
                    createdAt: new Date().toISOString()
                }).then(() => {
                    document.getElementById('result').innerText = `Capsule "${title}" sealed! Opens on ${unlockDate}.`;
                    window.Telegram.WebApp.showAlert('Capsule created!');
                }).catch(error => {
                    window.Telegram.WebApp.showAlert('Error: ' + error.message);
                });
            } else {
                window.Telegram.WebApp.showAlert('Fill all fields!');
            }
        });

        window.Telegram.WebApp.expand();
        window.Telegram.WebApp.ready();
    </script>
</body>
</html>
